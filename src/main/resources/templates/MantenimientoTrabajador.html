<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layouts/layoutPrincipal :: head">

</head>
<link rel="stylesheet" href="../static/css/font-awesome.min.css"/>
<link rel="stylesheet" href="../static/css/contact-form.css"/>


<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css"/>    
<style>
	.modal-header, .close {
		background-color: #286090;
		color: white !important;
		text-align: center;
		font-size: 20px;
	}    
</style>


	
<body>

<header th:replace="layouts/layoutPrincipal :: header"> </header>


		<!-- modal para confirmar eliminación -->
		 <div class="modal fade" id="modalEliminar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog modal-dialog-centered">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLabel">Eliminar</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body">
		        <form action="" method="post">
		        	<input type="hidden" name="#" id="id">
		        	<h5>Seguro de eliminar registro?</h5>
		        	 <div class="modal-footer">
				        <a class="btn btn-primary" id="btnEliminar">SI</a>
						<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>			        
				     </div>
		        </form>
		      </div>
		     
		    </div>
		  </div>
		</div>


		<!-- modal para confirmar registrar y actualizar -->
		<div class="modal fade" id="modalActualizar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLabel"></h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body">
		        								<div class="col-sm-12">
									<div class="item-wrap">
										<div class="row">
											<div class="col-sm-12">
												<div class="item-content colBottomMargin">
														<div class="card-header">FORMULARIO DE REGISTRO DE TRABAJADOR</div>
											   </div><!--End item-content -->
											</div><!--End col -->
											<div class="col-md-12">
												<div style="text-align:right">
													<span class="sub-text">(*) Campos requeridos</span>
												</div>	
											</div>
											<div class="col-md-12">
											<form  action="save" data-toggle="validator"
													class="popup-form" id="id_registra" method="post">
													
													<input type="text" name="#" id="#" value="0">
														<div class="row">
															<div class="form-group col-sm-6">
																<div class="subTitulos">Dni(*)</div>
																	<div class="ubicacion">
																		<div class="input-group-icon">
																			<i class="fa fa-id-card"></i>
																		</div>
																	</div>	
																	<input type="text" class="form-control" id="dni" name="dni" placeholder="Ingresar dni" required>
															</div>	
															<div class="form-group col-sm-6">
																<div class="subTitulos">Nombre(*)</div>
																<div class="ubicacion">
																	<div class="input-group-icon">
																		<i class="fa fa-user"></i>
																	</div>
																</div>	
																		<input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ingresar nombre" required>
															</div>		
															<div class="form-group col-sm-6">
																<div class="subTitulos">Apellido</div>
																<div class="ubicacion">
																	<div class="input-group-icon">
																		<i class="fa fa-user"></i>
																	</div>
																</div>	
																		<input type="text" class="form-control" id="apellido" name="apellido" placeholder="Ingresar apellido" required>
															</div>	
															<div class="form-group col-sm-6">
																<div class="subTitulos">Correo</div>
																<div class="ubicacion">
																	<div class="input-group-icon">
																		<i class="fa fa-email"></i>
																	</div>
																</div>	
																		<input type="text" class="form-control" id="correo" name="correo" placeholder="Ingresar correo" required>
															</div>
															
															<div class="form-group col-sm-6">
																<div class="subTitulos">Password</div>
																<div class="ubicacion">
																	<div class="input-group-icon">
																		<i class="fa fa-email"></i>
																	</div>
																</div>	
																		<input type="password" class="form-control" id="password" name="password" placeholder="Ingresar password" required>
															</div>
															
															<div class="form-group col-sm-10">
																<div class="subTitulos">Rol(*)</div>
																<div class="ubicacion">
																	<div class="input-group-icon">
																		<i class="fa fa-car"></i>
																	</div>
																</div>	
																	<div id="divDistrito">
																		<select class="form-control" id="rol" name="rol">
																		  <option value="">[Seleccione Rol]</option>
		   																  <option th:each="bean:${roles}"
		   																  			th:value="${bean.idrol}"
		   																  			th:utext="${bean.nombre}">
		   																  <option>GESTOR</option>
		   																  	<option>FIRMANTE</option>
																		</select>
																	</div>	
															</div>
															
															<div class="form-group last col-sm-12">
																	<div class="ubicacionPie">
																		<button type="submit" class="btn btn-success"><i class='fa fa-save'></i> REGISTRAR</button>
																	 </div>
																</div><!-- end form-group -->	
		
															</div><!-- end row -->
														</form><!-- end form -->
											</div>
										</div><!--End row -->
										<!-- Popup end -->
									</div><!-- end item-wrap -->
								</div><!--End col -->
		      </div>
		    </div>
		  </div>
		</div>





	<div class="container dentro">
		<div class="alert alert-warning alert-dismissible fade show" 
				role="alert" th:if="${MENSAJE!=null}">
			  <strong><span th:text="${MENSAJE}"></span></strong>
			  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
			    <span aria-hidden="true">&times;</span>
			  </button>
		</div>
		
			
			<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalActualizar">
			  Nuevo
			</button>
			
			<div class="container">
			   <div class="d-flex">
				     <label class="col-form-label me-4" style="margin-left: 80%;">Rol:</label>	
				     <select class="form-control me-2" style="width: 15%;" placeholder="Ingresar rol" >
				     <option value="">[Seleccione Rol]</option>
				     	<option>TODOS</option>
				     	<option>GESTOR</option>
		   				<option>FIRMANTE</option>
				     </select>
				     <button class="btn btn-outline-primary" type="submit" width="100">Filtrar</button>
			   </div>
			</div>
						 
			<div class="mt-2">
				<table id="example" class="table table-striped table-bordered" style="width:100%">
			        <thead>
			            <tr>
			                <th>ID</th>
			                <th>Dni</th>
			                <th>Nombre</th>
			                <th>Apellido</th>
			                <th>Correo</th>
			                <th>Rol</th>
			                <th></th>
			                <th></th>
			            </tr>
			        </thead>
			        <tbody>
						 <tr th:each="bean: ${trabajadores}">
					      <td th:text="${bean.idtrabajador}"></td>
					      <td th:text="${bean.dni}"></td>
					      <td th:text="${bean.nombre}"></td>
					      <td th:text="${bean.apellido}"></td>
					      <td th:text="${bean.correo}"></td>
					      <td th:text="${bean.rol.nombre}"></td>
					      <td><a th:href="@{buscarTrabajador/(idtrabajador=${bean.idtrabajador})}" class="btn btn-success btnEditar">Editar</a></td>
					      <td><a th:href="@{eliminarTrabajador/(idtrabajador=${bean.idtrabajador})}" class="btn btn-info btnEliminar">Eliminar</a></td>
					    </tr>
					    
					    <tr>
					      <td>2</td>
					      <td > 78965412</td>
					      <td> Juan</td>
					      <td> Torres</td>
					      <td> juan@gmail.com</td>
					      <td> Firmante</td>
					      <td><a href="#" class="btn btn-success btnEditar">Editar</a></td>
					      <td><a href="#" class="btn btn-danger btnEliminar">Eliminar</a></td>
					    </tr>
					    
					    <tr>
					      <td>1</td>
					      <td > 15963284</td>
					      <td> Rosa</td>
					      <td> Camere</td>
					      <td> rosa@gmail.com</td>
					      <td> Gestor</td>
					      <td><a href="#" class="btn btn-success btnEditar">Editar</a></td>
					      <td><a href="#" class="btn btn-danger btnEliminar">Eliminar</a></td>
					    </tr>
					    
			        </tbody>
		    	</table>	
		 </div>   		
		 
		 
	 </div>
	 
	 <section>
		<nav th:replace="layouts/paginador :: paginador"></nav>
	</section>
			
		 <footer th:replace="layouts/layoutPrincipal :: footer">	</footer>
		 

	
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

 
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-validator/0.5.3/js/bootstrapValidator.min.js"></script> 	
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script> 
<!--<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script> -->
 
 <script type="text/javascript">
	 $(document).ready(function() {
		$('#example').DataTable();
	})
 </script>	 
 	<script type="text/javascript">
 	
 	$('.alert').fadeIn();     
	  	setTimeout(function() {
	       $(".alert").fadeOut();           
	  },2000);
	
	  		 
	$(".table .btnEliminar").on("click",function(){
 		event.preventDefault();
		var href=$(this).attr("href");
		$("#btnEliminar").attr('href',href);
		$("#modalEliminar").modal("show");
 	})
	
	$(".table .btnEditar").on("click",function(){
 		event.preventDefault();
 		var href=$(this).attr("href");
 		$.get(href,function(response){
 			$("#idtrabajador").val(response.idtrabajador);
 			$("#dni").val(response.dni);
 			$("#nombre").val(response.nombre);
 			$("#apellido").val(response.apellido);
 			$("#correo").val(response.correo);
 			$("#password").val(response.password);
 			$("#rol").val(response.rol.idrol);	
 		});
 		$("#modalActualizar").modal("show");
 				
 	})
 		
 		
 		
	
	</script>
	<script type="text/javascript">    
    $(document).ready(function(){     
        $('#id_registra').bootstrapValidator({      
        	 fields:{
        		 dni:{
       			 	validators:{
       			 		notEmpty:{
       			 			message:'Campo dni es obligatorio'	
       			 		},
       			 		digits:{
       			 			message:'Campo dni es solo digitos'
       			 		},
       			 		regexp:{
      			 			regexp:/^(\d){8}$/,
      			 			message:'Campo cantidad son 8 dígitos'
      			 		}
       			 	}
       		 	 },  
        		 nombre:{
     			 	validators:{
     			 		notEmpty:{
     			 			message:'Campo nombre es obligatorio'	
     			 		},
     			 		regexp:{
     			 			regexp:/^[a-zA-Z\s\ñ\Ñ\á\é]{3,45}$/,
     			 			message:'Campo nombre solo letras min 3 hasta max 45 letras'
     			 		}
     			 	}
     		 },   
     		 apellido:{
  			 	validators:{
  			 		notEmpty:{
  			 			message:'Campo apellido es obligatorio'	
  			 		},
  			 		regexp:{
  			 			regexp:/^[a-zA-Z\s\ñ\Ñ\á\é]{3,45}$/,
  			 			message:'Campo apellido solo letras min 3 hasta max 45 letras'
  			 		}
  			 	}
  		 },   
  		correo:{
			 	validators:{
			 		notEmpty:{
			 			message:'Campo correo es obligatorio'	
			 		},
			 		emailAddress:{
			 			message:'Campo correo debe ser como el siguiente formato "example@gmail.com" '
			 		}
			 	}
		 },   
		 password:{
			 	validators:{
			 		notEmpty:{
			 			message:'Campo password es obligatorio'	
			 		},
			 		regexp:{
			 			regexp:/^[a-zA-Z\s\ñ\Ñ\á\é\d]{3,45}$/,
			 			message:'Campo password solo letras min 3 hasta max 45 caracteres'
			 		}
			 	}
		 },   
     		  		 
  		 	celular:{
  			 	validators:{
  			 		notEmpty:{
  			 			message:'Campo celular es obligatorio'	
  			 		},
  			 		digits:{
  			 			message:'Campo celular es solo digitos'
  			 		},
  			 		regexp:{
 			 			regexp:/^(\d){9}$/,
 			 			message:'Campo celular son 9 dígitos'
 			 		}
  			 	}
  		 	 },  
  		 	  
  		 	 
  		 	 
                 
        	 }
        });   
			
    });    
</script>   

</body>
</html>